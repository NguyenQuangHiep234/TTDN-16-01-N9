# PHÃ‚N TÃCH CHá»¨C NÄ‚NG AI QUáº¢N LÃ Rá»¦I RO Dá»° ÃN

**Module**: `project_management`  
**TÃ­nh nÄƒng**: AI Risk Management - Quáº£n lÃ½ Rá»§i ro Tá»± Ä‘á»™ng  
**PhiÃªn báº£n**: 1.0  
**NgÃ y**: 28/01/2026

---

## ğŸ“‹ Má»¤C Lá»¤C

1. [Tá»•ng quan há»‡ thá»‘ng](#1-tá»•ng-quan-há»‡-thá»‘ng)
2. [Kiáº¿n trÃºc há»‡ thá»‘ng](#2-kiáº¿n-trÃºc-há»‡-thá»‘ng)
3. [Luá»“ng hoáº¡t Ä‘á»™ng chi tiáº¿t](#3-luá»“ng-hoáº¡t-Ä‘á»™ng-chi-tiáº¿t)
4. [Thuáº­t toÃ¡n phÃ¡t hiá»‡n rá»§i ro](#4-thuáº­t-toÃ¡n-phÃ¡t-hiá»‡n-rá»§i-ro)
5. [CÃ´ng thá»©c tÃ­nh toÃ¡n](#5-cÃ´ng-thá»©c-tÃ­nh-toÃ¡n)
6. [PhÃ¢n loáº¡i vÃ  Ä‘Ã¡nh giÃ¡](#6-phÃ¢n-loáº¡i-vÃ -Ä‘Ã¡nh-giÃ¡)
7. [CÆ¡ cháº¿ tá»± Ä‘á»™ng hÃ³a](#7-cÆ¡-cháº¿-tá»±-Ä‘á»™ng-hÃ³a)
8. [TÃ­ch há»£p vÃ  má»Ÿ rá»™ng](#8-tÃ­ch-há»£p-vÃ -má»Ÿ-rá»™ng)

---

## 1. Tá»”NG QUAN Há»† THá»NG

### 1.1. Má»¥c Ä‘Ã­ch

Há»‡ thá»‘ng AI Quáº£n lÃ½ Rá»§i ro Ä‘Æ°á»£c xÃ¢y dá»±ng Ä‘á»ƒ:

- **Tá»± Ä‘á»™ng phÃ¡t hiá»‡n** cÃ¡c rá»§i ro tiá»m áº©n trong dá»± Ã¡n
- **PhÃ¢n tÃ­ch nguyÃªn nhÃ¢n gá»‘c** (Root Cause Analysis)
- **Äá» xuáº¥t giáº£i phÃ¡p** kháº¯c phá»¥c cá»¥ thá»ƒ
- **Cáº£nh bÃ¡o sá»›m** Ä‘á»ƒ hÃ nh Ä‘á»™ng ká»‹p thá»i
- **Theo dÃµi liÃªn tá»¥c** tráº¡ng thÃ¡i rá»§i ro

### 1.2. Pháº¡m vi hoáº¡t Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PHáº M VI PHÃT HIá»†N                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Rá»§i ro Tiáº¿n Ä‘á»™ (Schedule Risk)                       â”‚
â”‚   - CÃ´ng viá»‡c trá»… háº¡n                                   â”‚
â”‚   - Tiáº¿n Ä‘á»™ cháº­m so vá»›i káº¿ hoáº¡ch                        â”‚
â”‚   - Critical path bá»‹ áº£nh hÆ°á»Ÿng                          â”‚
â”‚                                                         â”‚
â”‚ âœ“ Rá»§i ro NgÃ¢n sÃ¡ch (Budget Risk)                       â”‚
â”‚   - Chi phÃ­ vÆ°á»£t dá»± toÃ¡n                                â”‚
â”‚   - Burn rate cao báº¥t thÆ°á»ng                            â”‚
â”‚   - Thiáº¿u nguá»“n tÃ i chÃ­nh                               â”‚
â”‚                                                         â”‚
â”‚ âœ“ Rá»§i ro Nguá»“n lá»±c (Resource Risk)                     â”‚
â”‚   - NhÃ¢n viÃªn bá»‹ overload                               â”‚
â”‚   - PhÃ¢n bá»• khÃ´ng Ä‘á»u                                   â”‚
â”‚   - Thiáº¿u há»¥t skill cáº§n thiáº¿t                           â”‚
â”‚                                                         â”‚
â”‚ âœ“ Rá»§i ro Cháº¥t lÆ°á»£ng (Quality Risk)                     â”‚
â”‚   - Tá»· lá»‡ lá»—i cao                                       â”‚
â”‚   - Rework nhiá»u láº§n                                    â”‚
â”‚                                                         â”‚
â”‚ âœ“ Rá»§i ro Pháº¡m vi (Scope Risk)                          â”‚
â”‚   - Scope creep (thÃªm yÃªu cáº§u liÃªn tá»¥c)                â”‚
â”‚   - Thay Ä‘á»•i requirements thÆ°á»ng xuyÃªn                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. KIáº¾N TRÃšC Há»† THá»NG

### 2.1. SÆ¡ Ä‘á»“ kiáº¿n trÃºc tá»•ng thá»ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERFACE                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Projects   â”‚  â”‚  Risk List   â”‚  â”‚  Dashboard   â”‚        â”‚
â”‚  â”‚     Form     â”‚  â”‚  Kanban/Tree â”‚  â”‚   Metrics    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BUSINESS LOGIC LAYER                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              risk.ai.engine (AI Core)                â”‚     â”‚
â”‚  â”‚  - detect_schedule_risk()                            â”‚     â”‚
â”‚  â”‚  - detect_budget_risk()                              â”‚     â”‚
â”‚  â”‚  - detect_resource_risk()                            â”‚     â”‚
â”‚  â”‚  - analyze_project_risks() [Main Orchestrator]       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚           risk.assessment (Risk Records)             â”‚     â”‚
â”‚  â”‚  - LÆ°u trá»¯ rá»§i ro phÃ¡t hiá»‡n                          â”‚     â”‚
â”‚  â”‚  - TÃ­nh toÃ¡n risk score, level                       â”‚     â”‚
â”‚  â”‚  - Quáº£n lÃ½ lifecycle (identified â†’ resolved)         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTO-TRIGGER LAYER                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Projects    â”‚  â”‚  Cong Viec   â”‚  â”‚   Budgets    â”‚        â”‚
â”‚  â”‚  Triggers    â”‚  â”‚  Triggers    â”‚  â”‚   Triggers   â”‚        â”‚
â”‚  â”‚ create()     â”‚  â”‚ create()     â”‚  â”‚ create()     â”‚        â”‚
â”‚  â”‚ write()      â”‚  â”‚ write()      â”‚  â”‚ write()      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATA LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   projects   â”‚  â”‚  cong_viec   â”‚  â”‚   budgets    â”‚        â”‚
â”‚  â”‚   budgets    â”‚  â”‚  nhiem_vu    â”‚  â”‚   expenses   â”‚        â”‚
â”‚  â”‚  nhan_vien   â”‚  â”‚              â”‚  â”‚              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTOMATION LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         Scheduled Job (ir.cron)                      â”‚     â”‚
â”‚  â”‚  Cháº¡y má»—i ngÃ y 2:00 AM                               â”‚     â”‚
â”‚  â”‚  â†’ run_scheduled_analysis()                          â”‚     â”‚
â”‚  â”‚  â†’ QuÃ©t toÃ n bá»™ dá»± Ã¡n active                         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2. MÃ´ hÃ¬nh dá»¯ liá»‡u (Data Models)

#### **risk.assessment**

```python
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   risk.assessment                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + id: Integer (PK)                                      â”‚
â”‚ + name: Char                      # TÃªn rá»§i ro          â”‚
â”‚ + project_id: Many2one(projects)  # Dá»± Ã¡n liÃªn quan     â”‚
â”‚ + risk_type: Selection            # schedule/budget/... â”‚
â”‚ + risk_level: Selection           # low/medium/high/... â”‚
â”‚ + probability: Float              # 0-100%              â”‚
â”‚ + impact_score: Float             # 1-10                â”‚
â”‚ + risk_score: Float (computed)    # Auto calculate      â”‚
â”‚ + description: Text                                     â”‚
â”‚ + root_cause: Text                # AI generated        â”‚
â”‚ + mitigation_plan: Text           # AI suggested        â”‚
â”‚ + status: Selection               # identified/resolved â”‚
â”‚ + is_ai_detected: Boolean                               â”‚
â”‚ + ai_confidence: Float            # 0-100%              â”‚
â”‚ + detected_date: Datetime                               â”‚
â”‚ + resolved_date: Datetime                               â”‚
â”‚ + assigned_to: Many2one(nhan_vien)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **risk.metric**

```python
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     risk.metric                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + id: Integer (PK)                                      â”‚
â”‚ + project_id: Many2one(projects)                        â”‚
â”‚ + metric_type: Selection          # CPI/SPI/Burn Rate  â”‚
â”‚ + value: Float                                          â”‚
â”‚ + threshold_min: Float                                  â”‚
â”‚ + threshold_max: Float                                  â”‚
â”‚ + is_anomaly: Boolean (computed)                        â”‚
â”‚ + date: Date                                            â”‚
â”‚ + notes: Text                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **risk.ai.engine**

```python
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  risk.ai.engine                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Methods (khÃ´ng cÃ³ persistent data):                     â”‚
â”‚ + detect_schedule_risk(project) â†’ list[risk_dict]      â”‚
â”‚ + detect_budget_risk(project) â†’ list[risk_dict]        â”‚
â”‚ + detect_resource_risk(project) â†’ list[risk_dict]      â”‚
â”‚ + analyze_project_risks(project_id) â†’ list[risk_dict]  â”‚
â”‚ + run_scheduled_analysis() â†’ bool                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. LUá»’NG HOáº T Äá»˜NG CHI TIáº¾T

### 3.1. Luá»“ng tá»± Ä‘á»™ng khi táº¡o/cáº­p nháº­t dá»± Ã¡n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 1: User táº¡o hoáº·c cáº­p nháº­t dá»± Ã¡n                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 2: projects.create() hoáº·c projects.write() Ä‘Æ°á»£c gá»i   â”‚
â”‚                                                             â”‚
â”‚   def create(self, vals):                                  â”‚
â”‚       project = super().create(vals)                       â”‚
â”‚       if project.status in ['in_progress', 'not_started']: â”‚
â”‚           project._auto_analyze_risks_on_changes()         â”‚
â”‚       return project                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 3: _auto_analyze_risks_on_changes() trigger AI        â”‚
â”‚                                                             â”‚
â”‚   def _auto_analyze_risks_on_changes(self):                â”‚
â”‚       ai_engine = self.env['risk.ai.engine']               â”‚
â”‚       ai_engine.analyze_project_risks(self.id)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 4: analyze_project_risks() - Main Orchestrator        â”‚
â”‚                                                             â”‚
â”‚   1. Láº¥y thÃ´ng tin project                                 â”‚
â”‚   2. Gá»i detect_schedule_risk(project)                     â”‚
â”‚   3. Gá»i detect_budget_risk(project)                       â”‚
â”‚   4. Gá»i detect_resource_risk(project)                     â”‚
â”‚   5. Aggregate táº¥t cáº£ risks vÃ o all_risks[]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 5: Xá»­ lÃ½ má»—i risk trong all_risks                     â”‚
â”‚                                                             â”‚
â”‚   For each risk_data:                                      â”‚
â”‚     - Kiá»ƒm tra risk tÆ°Æ¡ng tá»± Ä‘Ã£ tá»“n táº¡i?                   â”‚
â”‚     - Náº¾U tá»“n táº¡i: UPDATE risk hiá»‡n cÃ³                     â”‚
â”‚     - Náº¾U chÆ°a cÃ³: CREATE risk má»›i                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 6: risk.assessment tá»± Ä‘á»™ng tÃ­nh risk_score & level    â”‚
â”‚                                                             â”‚
â”‚   @api.depends('probability', 'impact_score')              â”‚
â”‚   def _compute_risk_score(self):                           â”‚
â”‚       risk_score = (probability / 100) * impact * 10       â”‚
â”‚                                                             â”‚
â”‚   @api.depends('risk_score')                               â”‚
â”‚   def _compute_risk_level(self):                           â”‚
â”‚       if risk_score >= 70: level = 'critical'              â”‚
â”‚       elif risk_score >= 50: level = 'high'                â”‚
â”‚       elif risk_score >= 30: level = 'medium'              â”‚
â”‚       else: level = 'low'                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BÆ¯á»šC 7: Káº¿t quáº£ hiá»ƒn thá»‹ trong UI                          â”‚
â”‚   - Tab "Quáº£n lÃ½ rá»§i ro" cá»§a dá»± Ã¡n                         â”‚
â”‚   - Menu "AI Quáº£n lÃ½ rá»§i ro" (táº¥t cáº£ rá»§i ro)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2. Luá»“ng tá»± Ä‘á»™ng khi task thay Ä‘á»•i

```
User táº¡o/cáº­p nháº­t task (cong_viec)
         â†“
cong_viec.create() hoáº·c .write()
         â†“
auto_risk_triggers.py override:
    if task.du_an_id:
        _trigger_project_risk_analysis(task.du_an_id)
         â†“
AI engine phÃ¢n tÃ­ch dá»± Ã¡n
         â†“
Táº¡o/cáº­p nháº­t risks
```

### 3.3. Luá»“ng scheduled job (Daily Analysis)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Má»–I NGÃ€Y 2:00 AM                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Odoo Cron Job trigger:                                      â”‚
â”‚   model.run_scheduled_analysis()                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ def run_scheduled_analysis(self):                           â”‚
â”‚     # Láº¥y táº¥t cáº£ dá»± Ã¡n active                               â”‚
â”‚     projects = self.env['projects'].search([                â”‚
â”‚         ('status', 'in', ['in_progress', 'not_started'])    â”‚
â”‚     ])                                                      â”‚
â”‚                                                             â”‚
â”‚     # PhÃ¢n tÃ­ch tá»«ng dá»± Ã¡n                                  â”‚
â”‚     for project in projects:                                â”‚
â”‚         self.analyze_project_risks(project.id)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Káº¿t quáº£: Táº¥t cáº£ dá»± Ã¡n Ä‘Æ°á»£c quÃ©t rá»§i ro hÃ ng ngÃ y           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. THUáº¬T TOÃN PHÃT HIá»†N Rá»¦I RO

### 4.1. Thuáº­t toÃ¡n phÃ¡t hiá»‡n Rá»§i ro Tiáº¿n Ä‘á»™

#### **Rule 1: PhÃ¡t hiá»‡n cÃ´ng viá»‡c delay**

```python
def detect_schedule_risk(self, project):
    """
    INPUT: project object
    OUTPUT: list of risk_dict
    """
    risks = []

    # BÆ°á»›c 1: Láº¥y danh sÃ¡ch task
    if not project.task_ids:
        return risks  # KhÃ´ng cÃ³ task â†’ khÃ´ng risk

    # BÆ°á»›c 2: TÃ­nh sá»‘ task delay
    today = fields.Date.today()
    delayed_tasks = project.task_ids.filtered(
        lambda t: (
            t.ngay_ket_thuc and
            t.ngay_ket_thuc < today and
            t.trang_thai != 'hoan_thanh'
        )
    )

    delayed_count = len(delayed_tasks)
    total_tasks = len(project.task_ids)
    delayed_percentage = (delayed_count / total_tasks * 100)

    # BÆ°á»›c 3: Ãp dá»¥ng rule
    if delayed_percentage > 30:
        # TÃ­nh probability
        probability = min(delayed_percentage, 100)

        # TÃ­nh impact
        if delayed_percentage > 50:
            impact = 8.0
        else:
            impact = 6.0

        # Táº¡o risk dictionary
        risk_data = {
            'name': f'Rá»§i ro tiáº¿n Ä‘á»™: {delayed_percentage:.0f}% cÃ´ng viá»‡c trá»… háº¡n',
            'risk_type': 'schedule',
            'probability': probability,
            'impact_score': impact,
            'description': f"PhÃ¡t hiá»‡n {delayed_count}/{total_tasks} cÃ´ng viá»‡c ({delayed_percentage:.1f}%) bá»‹ trá»… háº¡n.",
            'root_cause': """NguyÃªn nhÃ¢n cÃ³ thá»ƒ do:
                - Æ¯á»›c lÆ°á»£ng thá»i gian khÃ´ng chÃ­nh xÃ¡c
                - Thiáº¿u nguá»“n lá»±c hoáº·c nhÃ¢n viÃªn overload
                - CÃ¡c váº¥n Ä‘á» ká»¹ thuáº­t phÃ¡t sinh
                - Dependency giá»¯a cÃ¡c task bá»‹ cháº­m""",
            'mitigation_plan': """Äá» xuáº¥t kháº¯c phá»¥c:
                âœ“ Review láº¡i timeline vÃ  Æ°u tiÃªn cÃ´ng viá»‡c quan trá»ng
                âœ“ Bá»• sung nguá»“n lá»±c cho cÃ¡c task critical
                âœ“ Tá»• chá»©c daily standup Ä‘á»ƒ theo dÃµi sÃ¡t sao
                âœ“ CÃ¢n nháº¯c extend deadline hoáº·c giáº£m scope""",
            'ai_confidence': 85.0
        }

        risks.append(risk_data)

    return risks
```

**Luá»“ng logic:**

```
START
  â†“
CÃ³ tasks khÃ´ng? â†’ NO â†’ Return []
  â†“ YES
Äáº¿m tasks delay (ngay_ket_thuc < today AND trang_thai != 'hoan_thanh')
  â†“
TÃ­nh delayed_percentage = (delayed_count / total_tasks) Ã— 100
  â†“
delayed_percentage > 30%? â†’ NO â†’ Return []
  â†“ YES
TÃ­nh probability = min(delayed_percentage, 100)
  â†“
delayed_percentage > 50%? â†’ YES â†’ impact = 8.0
  â†“ NO
impact = 6.0
  â†“
Táº¡o risk_data dictionary
  â†“
Append vÃ o risks[]
  â†“
Return risks[]
END
```

#### **Rule 2: PhÃ¡t hiá»‡n tiáº¿n Ä‘á»™ tháº¥p khi sáº¯p háº¿t háº¡n**

```python
if project.actual_end_date:
    days_remaining = (project.actual_end_date - today).days

    # Rule: CÃ²n Ã­t ngÃ y nhÆ°ng progress tháº¥p
    if 0 < days_remaining <= 30 and project.progress < 70:
        probability = 90.0
        impact = 9.0

        risk_data = {
            'name': f'Nguy cÆ¡ cao trá»… deadline ({days_remaining} ngÃ y)',
            'risk_type': 'schedule',
            'probability': probability,
            'impact_score': impact,
            'description': f"Dá»± Ã¡n cÃ²n {days_remaining} ngÃ y nhÆ°ng chá»‰ hoÃ n thÃ nh {project.progress:.1f}%.",
            'root_cause': "Tá»‘c Ä‘á»™ thá»±c hiá»‡n quÃ¡ cháº­m so vá»›i káº¿ hoáº¡ch. Nguy cÆ¡ cao khÃ´ng hoÃ n thÃ nh Ä‘Ãºng háº¡n.",
            'mitigation_plan': """HÃ nh Ä‘á»™ng kháº©n cáº¥p:
                âœ“ Táº­p trung 100% team vÃ o cÃ¡c task cÃ²n láº¡i
                âœ“ Cut scope: Loáº¡i bá» features khÃ´ng cáº§n thiáº¿t
                âœ“ LÃ m thÃªm giá» hoáº·c thuÃª thÃªm freelancer
                âœ“ ThÃ´ng bÃ¡o stakeholder vá» kháº£ nÄƒng delay""",
            'ai_confidence': 90.0
        }

        risks.append(risk_data)
```

**Decision Tree:**

```
                  â”Œâ”€ CÃ³ actual_end_date? â”€â”
                  â”‚                        â”‚
                 YES                       NO â†’ Skip
                  â†“
        TÃ­nh days_remaining = actual_end_date - today
                  â†“
        â”Œâ”€ 0 < days_remaining <= 30? â”€â”
        â”‚                              â”‚
       YES                            NO â†’ Skip
        â†“
   â”Œâ”€ progress < 70%? â”€â”
   â”‚                    â”‚
  YES                  NO â†’ Skip
   â†“
Create HIGH RISK
(probability=90%, impact=9.0)
```

### 4.2. Thuáº­t toÃ¡n phÃ¡t hiá»‡n Rá»§i ro NgÃ¢n sÃ¡ch

#### **Rule 1: VÆ°á»£t ngÃ¢n sÃ¡ch**

```python
def detect_budget_risk(self, project):
    risks = []

    if not project.budget_ids:
        return risks

    # TÃ­nh tá»•ng
    total_budget = sum(project.budget_ids.mapped('budget_planned'))
    total_spent = sum(project.budget_ids.mapped('budget_spent'))

    if total_budget <= 0:
        return risks

    spent_percentage = (total_spent / total_budget) * 100

    # Rule 1: VÆ°á»£t 100%
    if spent_percentage > 100:
        overrun = total_spent - total_budget
        probability = 100.0
        impact = 10.0

        risk_data = {
            'name': f'VÆ°á»£t ngÃ¢n sÃ¡ch {spent_percentage - 100:.1f}%',
            'risk_type': 'budget',
            'probability': probability,
            'impact_score': impact,
            'description': f"ÄÃ£ chi {total_spent:,.0f} VND, vÆ°á»£t ngÃ¢n sÃ¡ch {overrun:,.0f} VND ({spent_percentage:.1f}%).",
            'root_cause': """NgÃ¢n sÃ¡ch Ä‘Ã£ bá»‹ vÆ°á»£t:
                - Æ¯á»›c lÆ°á»£ng chi phÃ­ ban Ä‘áº§u khÃ´ng chÃ­nh xÃ¡c
                - PhÃ¡t sinh chi phÃ­ ngoÃ i dá»± kiáº¿n
                - Thiáº¿u kiá»ƒm soÃ¡t chi tiÃªu""",
            'mitigation_plan': """Kháº¯c phá»¥c ngay:
                âœ“ Dá»ªNG má»i chi tiÃªu khÃ´ng cáº§n thiáº¿t
                âœ“ Review láº¡i táº¥t cáº£ expenses vÃ  cáº¯t giáº£m
                âœ“ Xin bá»• sung ngÃ¢n sÃ¡ch hoáº·c Ä‘iá»u chá»‰nh scope
                âœ“ Thiáº¿t láº­p approval process cháº·t cháº½ hÆ¡n""",
            'ai_confidence': 95.0
        }

        risks.append(risk_data)
```

#### **Rule 2: Burn Rate cao**

```python
# Rule 2: Chi tiÃªu nhanh hÆ¡n tiáº¿n Ä‘á»™
progress_percentage = project.progress

if spent_percentage > progress_percentage + 20:
    probability = 80.0
    impact = 7.0

    risk_data = {
        'name': f'Burn rate cao: Chi {spent_percentage:.0f}% vs Tiáº¿n Ä‘á»™ {progress_percentage:.0f}%',
        'risk_type': 'budget',
        'probability': probability,
        'impact_score': impact,
        'description': f"ÄÃ£ chi {spent_percentage:.1f}% ngÃ¢n sÃ¡ch nhÆ°ng chá»‰ hoÃ n thÃ nh {progress_percentage:.1f}% cÃ´ng viá»‡c.",
        'root_cause': """Chi tiÃªu nhanh hÆ¡n tiáº¿n Ä‘á»™:
            - Front-loading expenses (chi nhiá»u á»Ÿ giai Ä‘oáº¡n Ä‘áº§u)
            - NÄƒng suáº¥t lÃ m viá»‡c tháº¥p
            - Chi phÃ­ cá»‘ Ä‘á»‹nh cao""",
        'mitigation_plan': """HÃ nh Ä‘á»™ng:
            âœ“ PhÃ¢n tÃ­ch chi tiáº¿t tá»«ng khoáº£n chi
            âœ“ Tá»‘i Æ°u hÃ³a chi phÃ­, loáº¡i bá» waste
            âœ“ Dá»± bÃ¡o budget cuá»‘i ká»³ (EAC)
            âœ“ TÄƒng tá»‘c Ä‘á»™ hoÃ n thÃ nh cÃ´ng viá»‡c""",
        'ai_confidence': 80.0
    }

    risks.append(risk_data)
```

**Báº£ng quyáº¿t Ä‘á»‹nh Burn Rate:**

| Spent % | Progress % | Delta | ÄÃ¡nh giÃ¡        | Action               |
| ------- | ---------- | ----- | --------------- | -------------------- |
| 30%     | 40%        | -10%  | âœ… Tá»‘t          | Theo dÃµi bÃ¬nh thÆ°á»ng |
| 50%     | 50%        | 0%    | âœ… On track     | Duy trÃ¬              |
| 60%     | 50%        | +10%  | âš ï¸ Cáº£nh bÃ¡o     | Monitor cháº·t         |
| 70%     | 40%        | +30%  | ğŸ”´ Nguy hiá»ƒm    | **CREATE RISK**      |
| 80%     | 50%        | +30%  | ğŸ”´ NghiÃªm trá»ng | **CREATE HIGH RISK** |

### 4.3. Thuáº­t toÃ¡n phÃ¡t hiá»‡n Rá»§i ro Nguá»“n lá»±c

```python
def detect_resource_risk(self, project):
    risks = []

    if not project.task_ids:
        return risks

    # PhÃ¢n tÃ­ch workload
    workload_data = {}
    for task in project.task_ids.filtered(
        lambda t: t.trang_thai in ['moi', 'dang_thuc_hien']
    ):
        for employee in task.nhan_vien_phan_cong_ids:
            if employee not in workload_data:
                workload_data[employee] = []
            workload_data[employee].append(task)

    # TÃ¬m overload (>5 tasks)
    overloaded = []
    for employee, tasks in workload_data.items():
        if len(tasks) > 5:
            overloaded.append((employee, len(tasks)))

    if overloaded:
        probability = min(len(overloaded) * 20 + 40, 95)
        impact = 7.0

        overload_list = "\n".join([
            f"- {emp.ten_nv}: {count} cÃ´ng viá»‡c"
            for emp, count in overloaded
        ])

        risk_data = {
            'name': f'Rá»§i ro nguá»“n lá»±c: {len(overloaded)} nhÃ¢n viÃªn overload',
            'risk_type': 'resource',
            'probability': probability,
            'impact_score': impact,
            'description': f"PhÃ¡t hiá»‡n {len(overloaded)} nhÃ¢n viÃªn bá»‹ overload:\n{overload_list}",
            'root_cause': """PhÃ¢n bá»• cÃ´ng viá»‡c khÃ´ng há»£p lÃ½:
                - Má»™t sá»‘ nhÃ¢n viÃªn nháº­n quÃ¡ nhiá»u task
                - Thiáº¿u resource planning
                - Key persons bá»‹ phá»¥ thuá»™c quÃ¡ nhiá»u""",
            'mitigation_plan': """Giáº£i phÃ¡p:
                âœ“ CÃ¢n báº±ng láº¡i workload giá»¯a cÃ¡c thÃ nh viÃªn
                âœ“ Reassign tasks tá»« ngÆ°á»i overload sang ngÆ°á»i ráº£nh
                âœ“ Bá»• sung thÃªm nhÃ¢n sá»± náº¿u cáº§n
                âœ“ Æ¯u tiÃªn task theo má»©c Ä‘á»™ quan trá»ng""",
            'ai_confidence': 85.0
        }

        risks.append(risk_data)

    return risks
```

**CÃ´ng thá»©c tÃ­nh Probability:**

```
Probability = min(sá»‘_ngÆ°á»i_overload Ã— 20% + 40%, 95%)

VÃ­ dá»¥:
- 1 ngÆ°á»i overload: 20 Ã— 1 + 40 = 60%
- 2 ngÆ°á»i overload: 20 Ã— 2 + 40 = 80%
- 3 ngÆ°á»i overload: 20 Ã— 3 + 40 = 100% â†’ min(100, 95) = 95%
```

---

## 5. CÃ”NG THá»¨C TÃNH TOÃN

### 5.1. Risk Score (Äiá»ƒm rá»§i ro)

**CÃ´ng thá»©c cÆ¡ báº£n:**

```
Risk Score = (Probability / 100) Ã— Impact Score Ã— 10
```

**Trong Ä‘Ã³:**

- `Probability`: XÃ¡c suáº¥t xáº£y ra (0-100%)
- `Impact Score`: Má»©c Ä‘á»™ tÃ¡c Ä‘á»™ng (1-10)
- Há»‡ sá»‘ 10: Scale Ä‘á»ƒ Ä‘iá»ƒm náº±m trong khoáº£ng 0-100

**VÃ­ dá»¥ tÃ­nh toÃ¡n:**

| Probability | Impact | TÃ­nh toÃ¡n           | Risk Score | Level    |
| ----------- | ------ | ------------------- | ---------- | -------- |
| 80%         | 8      | (80/100) Ã— 8 Ã— 10   | **64**     | High     |
| 90%         | 9      | (90/100) Ã— 9 Ã— 10   | **81**     | Critical |
| 50%         | 6      | (50/100) Ã— 6 Ã— 10   | **30**     | Medium   |
| 30%         | 5      | (30/100) Ã— 5 Ã— 10   | **15**     | Low      |
| 100%        | 10     | (100/100) Ã— 10 Ã— 10 | **100**    | Critical |

**Code implementation:**

```python
@api.depends('probability', 'impact_score')
def _compute_risk_score(self):
    for record in self:
        record.risk_score = (record.probability / 100.0) * record.impact_score * 10
```

### 5.2. Delayed Percentage (Tá»· lá»‡ delay)

```
Delayed Percentage = (Sá»‘ tasks delay / Tá»•ng sá»‘ tasks) Ã— 100%
```

**Äiá»u kiá»‡n task Ä‘Æ°á»£c coi lÃ  delay:**

```python
task.ngay_ket_thuc < today AND task.trang_thai != 'hoan_thanh'
```

### 5.3. Spent Percentage (Tá»· lá»‡ chi tiÃªu)

```
Spent Percentage = (Tá»•ng chi phÃ­ thá»±c táº¿ / Tá»•ng ngÃ¢n sÃ¡ch) Ã— 100%
```

```python
total_budget = sum(project.budget_ids.mapped('budget_planned'))
total_spent = sum(project.budget_ids.mapped('budget_spent'))
spent_percentage = (total_spent / total_budget) Ã— 100
```

### 5.4. Burn Rate Delta

```
Burn Rate Delta = Spent % - Progress %
```

**ÄÃ¡nh giÃ¡:**

- `Delta < 0`: Chi tiÃªu cháº­m hÆ¡n tiáº¿n Ä‘á»™ (âœ… Tá»‘t)
- `Delta = 0`: Chi tiÃªu cÃ¢n báº±ng tiáº¿n Ä‘á»™ (âœ… On track)
- `0 < Delta <= 20`: HÆ¡i cao (âš ï¸ Cáº£nh bÃ¡o)
- `Delta > 20`: QuÃ¡ cao (ğŸ”´ Táº¡o risk)

### 5.5. Days Remaining

```
Days Remaining = actual_end_date - today
```

**Decision logic:**

```python
if 0 < days_remaining <= 30 and progress < 70:
    # HIGH RISK: Sáº¯p háº¿t háº¡n nhÆ°ng tiáº¿n Ä‘á»™ tháº¥p
    create_risk(probability=90%, impact=9)
```

### 5.6. Workload per Employee

```
Workload = Sá»‘ tasks Ä‘ang active Ä‘Æ°á»£c assign cho nhÃ¢n viÃªn
```

**Threshold:**

- `â‰¤ 3 tasks`: Normal
- `4-5 tasks`: High load
- `> 5 tasks`: **Overload** â†’ Táº¡o risk

---

## 6. PHÃ‚N LOáº I VÃ€ ÄÃNH GIÃ

### 6.1. Risk Level Classification

**CÃ´ng thá»©c:**

```python
@api.depends('risk_score')
def _compute_risk_level(self):
    for record in self:
        if record.risk_score >= 70:
            record.risk_level = 'critical'
        elif record.risk_score >= 50:
            record.risk_level = 'high'
        elif record.risk_score >= 30:
            record.risk_level = 'medium'
        else:
            record.risk_level = 'low'
```

**Báº£ng phÃ¢n loáº¡i:**

| Risk Score | Level    | Icon | MÃ u sáº¯c | HÃ nh Ä‘á»™ng              |
| ---------- | -------- | ---- | ------- | ---------------------- |
| 70-100     | Critical | ğŸ”´   | Red     | **Xá»­ lÃ½ ngay láº­p tá»©c** |
| 50-69      | High     | ğŸŸ    | Orange  | Xá»­ lÃ½ trong 2-3 ngÃ y   |
| 30-49      | Medium   | ğŸŸ¡   | Yellow  | Monitor vÃ  review      |
| 0-29       | Low      | ğŸŸ¢   | Green   | Accept hoáº·c theo dÃµi   |

**VÃ­ dá»¥ mapping:**

```
Risk Score = 85 â†’ Critical
Risk Score = 64 â†’ High
Risk Score = 42 â†’ Medium
Risk Score = 15 â†’ Low
```

### 6.2. Risk Type Classification

| Type         | Description       | Nguá»“n dá»¯ liá»‡u            | Frequency         |
| ------------ | ----------------- | ------------------------ | ----------------- |
| **schedule** | Rá»§i ro tiáº¿n Ä‘á»™    | `cong_viec`, `projects`  | Real-time + Daily |
| **budget**   | Rá»§i ro ngÃ¢n sÃ¡ch  | `budgets`, `expenses`    | Real-time + Daily |
| **resource** | Rá»§i ro nguá»“n lá»±c  | `nhan_vien`, `cong_viec` | Real-time + Daily |
| **quality**  | Rá»§i ro cháº¥t lÆ°á»£ng | (Future)                 | Daily             |
| **scope**    | Rá»§i ro pháº¡m vi    | (Future)                 | Weekly            |

### 6.3. Risk Status Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ identified  â”‚ â† AI phÃ¡t hiá»‡n láº§n Ä‘áº§u
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  analyzing  â”‚ â† PM Ä‘ang phÃ¢n tÃ­ch
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mitigating  â”‚ â† Äang thá»±c hiá»‡n kháº¯c phá»¥c
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
    â”Œâ”€â”€â”´â”€â”€â”
    â†“     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚resolvedâ”‚ â”‚ accepted â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   âœ…         âš ï¸
```

**Chuyá»ƒn Ä‘á»•i tráº¡ng thÃ¡i:**

```python
def action_start_mitigation(self):
    self.write({'status': 'mitigating'})

def action_resolve(self):
    self.write({
        'status': 'resolved',
        'resolved_date': fields.Datetime.now()
    })

def action_accept_risk(self):
    self.write({'status': 'accepted'})
```

### 6.4. AI Confidence Score

AI Confidence biá»ƒu thá»‹ Ä‘á»™ tin cáº­y cá»§a viá»‡c phÃ¡t hiá»‡n.

**Thang Ä‘iá»ƒm:**

- **95%**: Ráº¥t cháº¯c cháº¯n (vÃ­ dá»¥: vÆ°á»£t ngÃ¢n sÃ¡ch 100% â†’ rÃµ rÃ ng)
- **85-90%**: Cháº¯c cháº¯n cao (vÃ­ dá»¥: 40% tasks delay)
- **75-80%**: Cháº¯c cháº¯n trung bÃ¬nh (vÃ­ dá»¥: burn rate cao)
- **60-70%**: Cháº¯c cháº¯n tháº¥p (cáº§n xÃ¡c nháº­n)

**Sá»­ dá»¥ng:**

```python
'ai_confidence': 85.0  # 85% tin cáº­y
```

User cÃ³ thá»ƒ filter risks theo confidence Ä‘á»ƒ Æ°u tiÃªn xá»­ lÃ½.

---

## 7. CÆ  CHáº¾ Tá»° Äá»˜NG HÃ“A

### 7.1. Auto-trigger khi dá»¯ liá»‡u thay Ä‘á»•i

#### **Trigger Points:**

| Event          | Trigger Method       | File                           |
| -------------- | -------------------- | ------------------------------ |
| Create project | `projects.create()`  | `models/projects.py`           |
| Update project | `projects.write()`   | `models/projects.py`           |
| Create task    | `cong_viec.create()` | `models/auto_risk_triggers.py` |
| Update task    | `cong_viec.write()`  | `models/auto_risk_triggers.py` |
| Create budget  | `budgets.create()`   | `models/auto_risk_triggers.py` |
| Update budget  | `budgets.write()`    | `models/auto_risk_triggers.py` |
| Create expense | `expenses.create()`  | `models/auto_risk_triggers.py` |
| Update expense | `expenses.write()`   | `models/auto_risk_triggers.py` |

#### **Implementation Pattern:**

```python
class CongViecRiskTrigger(models.Model):
    _inherit = 'cong_viec'

    @api.model
    def create(self, vals):
        # Táº¡o record trÆ°á»›c
        task = super().create(vals)

        # Trigger AI analysis
        if task.du_an_id:
            self._trigger_project_risk_analysis(task.du_an_id)

        return task

    def write(self, vals):
        # Update record trÆ°á»›c
        result = super().write(vals)

        # Chá»‰ trigger khi field quan trá»ng thay Ä‘á»•i
        important_fields = ['trang_thai', 'ti_le_hoan_thanh', 'ngay_ket_thuc']

        if any(field in vals for field in important_fields):
            for task in self:
                if task.du_an_id:
                    self._trigger_project_risk_analysis(task.du_an_id)

        return result
```

**Lá»£i Ã­ch:**

- âœ… Real-time detection
- âœ… KhÃ´ng cáº§n user action
- âœ… LuÃ´n up-to-date
- âœ… TrÃ¡nh miss risks

### 7.2. Scheduled Job (Batch Analysis)

**Cáº¥u hÃ¬nh trong `data/risk_cron.xml`:**

```xml
<record id="ir_cron_risk_analysis" model="ir.cron">
    <field name="name">AI Risk Analysis: Daily Project Risk Detection</field>
    <field name="model_id" ref="model_risk_ai_engine"/>
    <field name="state">code</field>
    <field name="code">model.run_scheduled_analysis()</field>
    <field name="interval_number">1</field>
    <field name="interval_type">days</field>
    <field name="nextcall" eval="(DateTime.now() + timedelta(days=1)).strftime('%Y-%m-%d 02:00:00')"/>
</record>
```

**Logic:**

```python
def run_scheduled_analysis(self):
    # Láº¥y táº¥t cáº£ dá»± Ã¡n active
    projects = self.env['projects'].search([
        ('status', 'in', ['in_progress', 'not_started'])
    ])

    _logger.info(f"Starting scheduled risk analysis for {len(projects)} projects")

    total_risks = 0
    for project in projects:
        try:
            risks = self.analyze_project_risks(project.id)
            total_risks += len(risks)
        except Exception as e:
            _logger.error(f"Error analyzing project {project.projects_id}: {str(e)}")

    _logger.info(f"Scheduled analysis completed. Total risks detected: {total_risks}")
    return True
```

**Lá»£i Ã­ch:**

- âœ… Catch-all: Báº¯t cÃ¡c risk cÃ³ thá»ƒ bá»‹ miss
- âœ… Comprehensive analysis: PhÃ¢n tÃ­ch toÃ n diá»‡n
- âœ… Scheduled time: Cháº¡y lÃºc Ã­t traffic (2AM)

### 7.3. Deduplication Logic (TrÃ¡nh duplicate risks)

```python
# Kiá»ƒm tra risk tÆ°Æ¡ng tá»± Ä‘Ã£ tá»“n táº¡i
existing_risk = RiskAssessment.search([
    ('project_id', '=', project.id),
    ('risk_type', '=', risk_data['risk_type']),
    ('name', '=', risk_data['name']),
    ('status', 'in', ['identified', 'analyzing', 'mitigating'])
], limit=1)

if existing_risk:
    # UPDATE risk hiá»‡n cÃ³
    existing_risk.write({
        'probability': risk_data['probability'],
        'impact_score': risk_data['impact_score'],
        'description': risk_data['description'],
        'root_cause': risk_data['root_cause'],
        'mitigation_plan': risk_data['mitigation_plan'],
        'ai_confidence': risk_data['ai_confidence'],
    })
else:
    # CREATE risk má»›i
    RiskAssessment.create(risk_data)
```

**Logic:**

- Náº¿u risk cÃ¹ng `project_id`, `risk_type`, `name` vÃ  chÆ°a resolved â†’ UPDATE
- Náº¿u chÆ°a tá»“n táº¡i â†’ CREATE má»›i

**Lá»£i Ã­ch:**

- âœ… TrÃ¡nh spam notifications
- âœ… Keep history
- âœ… Update real-time metrics

---

## 8. TÃCH Há»¢P VÃ€ Má» Rá»˜NG

### 8.1. Extensibility - ThÃªm Rule má»›i

**VÃ­ dá»¥: ThÃªm phÃ¡t hiá»‡n Quality Risk**

```python
@api.model
def detect_quality_risk(self, project):
    """PhÃ¡t hiá»‡n rá»§i ro cháº¥t lÆ°á»£ng"""
    risks = []

    # Logic: TÃ­nh tá»· lá»‡ task bá»‹ reopen
    total_tasks = len(project.task_ids)
    if total_tasks == 0:
        return risks

    # Giáº£ sá»­ cÃ³ field 'reopen_count' trong task
    high_reopen_tasks = project.task_ids.filtered(lambda t: t.reopen_count > 2)
    reopen_percentage = (len(high_reopen_tasks) / total_tasks) * 100

    if reopen_percentage > 20:
        risks.append({
            'name': f'Rá»§i ro cháº¥t lÆ°á»£ng: {reopen_percentage:.0f}% tasks bá»‹ reopen',
            'risk_type': 'quality',
            'probability': min(reopen_percentage * 1.5, 100),
            'impact_score': 7.0,
            'description': f"{len(high_reopen_tasks)} tasks bá»‹ reopen nhiá»u láº§n",
            'root_cause': "Cháº¥t lÆ°á»£ng deliverable tháº¥p, thiáº¿u testing",
            'mitigation_plan': "TÄƒng cÆ°á»ng QA, code review cháº·t cháº½ hÆ¡n",
            'ai_confidence': 75.0
        })

    return risks
```

**Sau Ä‘Ã³ thÃªm vÃ o main orchestrator:**

```python
def analyze_project_risks(self, project_id):
    ...
    all_risks.extend(self.detect_schedule_risk(project))
    all_risks.extend(self.detect_budget_risk(project))
    all_risks.extend(self.detect_resource_risk(project))
    all_risks.extend(self.detect_quality_risk(project))  # NEW
    ...
```

### 8.2. Machine Learning Integration (Future)

**BÆ°á»›c 1: Collect training data**

```python
# Export historical data
SELECT
    project_id,
    progress,
    days_remaining,
    spent_percentage,
    delayed_percentage,
    team_size,
    budget_amount,
    CASE WHEN actual_end_date > planned_end_date THEN 1 ELSE 0 END as delayed_label
FROM projects
WHERE status = 'completed'
```

**BÆ°á»›c 2: Train model**

```python
import pandas as pd
from sklearn.ensemble import RandomForestClassifier

# Load data
df = pd.read_csv('project_data.csv')
X = df[['progress', 'days_remaining', 'spent_percentage', 'delayed_percentage', 'team_size']]
y = df['delayed_label']

# Train
model = RandomForestClassifier(n_estimators=100)
model.fit(X, y)

# Save
import pickle
pickle.dump(model, open('risk_model.pkl', 'wb'))
```

**BÆ°á»›c 3: Integrate vÃ o Odoo**

```python
import pickle
import numpy as np

@api.model
def ml_predict_delay_risk(self, project):
    """Dá»± bÃ¡o rá»§i ro delay báº±ng ML"""
    # Load model
    model = pickle.load(open('/path/to/risk_model.pkl', 'rb'))

    # Extract features
    features = np.array([[
        project.progress,
        (project.actual_end_date - fields.Date.today()).days if project.actual_end_date else 0,
        self._calculate_spent_percentage(project),
        self._calculate_delayed_percentage(project),
        len(project.task_ids.mapped('nhan_vien_phan_cong_ids'))
    ]])

    # Predict
    delay_probability = model.predict_proba(features)[0][1] * 100

    if delay_probability > 60:
        return {
            'name': f'ML: Dá»± bÃ¡o delay (Probability: {delay_probability:.0f}%)',
            'risk_type': 'schedule',
            'probability': delay_probability,
            'impact_score': 8.0,
            'description': 'Machine Learning model dá»± bÃ¡o dá»± Ã¡n cÃ³ nguy cÆ¡ delay cao',
            'ai_confidence': delay_probability
        }

    return None
```

### 8.3. External AI API Integration

**VÃ­ dá»¥: Sá»­ dá»¥ng OpenAI Ä‘á»ƒ phÃ¢n tÃ­ch text**

```python
import openai

@api.model
def ai_analyze_project_description(self, project):
    """Sá»­ dá»¥ng GPT Ä‘á»ƒ phÃ¢n tÃ­ch mÃ´ táº£ dá»± Ã¡n vÃ  tÃ¬m risks"""

    if not project.description:
        return []

    openai.api_key = 'your-api-key'

    prompt = f"""
    PhÃ¢n tÃ­ch mÃ´ táº£ dá»± Ã¡n sau vÃ  xÃ¡c Ä‘á»‹nh cÃ¡c rá»§i ro tiá»m áº©n:

    Dá»± Ã¡n: {project.projects_name}
    MÃ´ táº£: {project.description}

    Tráº£ vá» JSON vá»›i format:
    {{
        "risks": [
            {{
                "type": "schedule/budget/resource",
                "description": "...",
                "probability": 0-100,
                "impact": 1-10
            }}
        ]
    }}
    """

    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[{"role": "user", "content": prompt}]
    )

    # Parse response vÃ  táº¡o risks
    result = json.loads(response.choices[0].message.content)
    return result['risks']
```

### 8.4. Dashboard & Reporting

**Metrics cáº§n track:**

```python
# Portfolio-level metrics
total_projects = len(self.env['projects'].search([('status', '!=', 'completed')]))
projects_with_critical_risks = len(self.env['projects'].search([
    ('critical_risk_count', '>', 0)
]))
risk_coverage = (projects_with_critical_risks / total_projects) * 100

# Risk distribution
risk_by_type = self.env['risk.assessment'].read_group(
    [('status', 'not in', ['resolved', 'accepted'])],
    ['risk_type'],
    ['risk_type']
)

# Average risk score
avg_risk_score = self.env['risk.assessment'].search([
    ('status', 'not in', ['resolved', 'accepted'])
]).mapped('risk_score')
```

---

## 9. PERFORMANCE & OPTIMIZATION

### 9.1. Query Optimization

**Before:**

```python
for project in projects:
    for task in project.task_ids:
        if task.ngay_ket_thuc < today:
            # Process...
```

**After (vá»›i filtered):**

```python
for project in projects:
    delayed_tasks = project.task_ids.filtered(
        lambda t: t.ngay_ket_thuc and t.ngay_ket_thuc < today and t.trang_thai != 'hoan_thanh'
    )
    # Process delayed_tasks
```

### 9.2. Batch Processing

```python
# Process nhiá»u projects cÃ¹ng lÃºc trong scheduled job
def run_scheduled_analysis(self):
    projects = self.env['projects'].search([...])

    # Batch size Ä‘á»ƒ trÃ¡nh timeout
    BATCH_SIZE = 50

    for i in range(0, len(projects), BATCH_SIZE):
        batch = projects[i:i+BATCH_SIZE]
        for project in batch:
            self.analyze_project_risks(project.id)
        self.env.cr.commit()  # Commit sau má»—i batch
```

### 9.3. Caching (Future enhancement)

```python
from functools import lru_cache

@lru_cache(maxsize=100)
def _calculate_metrics(self, project_id):
    """Cache metrics calculation"""
    # Expensive calculation
    pass
```

---

## 10. Káº¾T LUáº¬N

### 10.1. TÃ³m táº¯t kiáº¿n trÃºc

**Há»‡ thá»‘ng AI Quáº£n lÃ½ Rá»§i ro** lÃ  má»™t giáº£i phÃ¡p toÃ n diá»‡n vá»›i:

1. **Rule-based AI Engine**: PhÃ¡t hiá»‡n rá»§i ro dá»±a trÃªn cÃ¡c quy táº¯c nghiá»‡p vá»¥ rÃµ rÃ ng
2. **Auto-trigger Mechanism**: Tá»± Ä‘á»™ng cháº¡y khi dá»¯ liá»‡u thay Ä‘á»•i
3. **Scheduled Analysis**: QuÃ©t Ä‘á»‹nh ká»³ Ä‘á»ƒ báº¯t cÃ¡c risk bá»‹ miss
4. **Smart Deduplication**: TrÃ¡nh táº¡o duplicate risks
5. **Computed Fields**: Tá»± Ä‘á»™ng tÃ­nh toÃ¡n risk score vÃ  level
6. **Extensible Architecture**: Dá»… dÃ ng thÃªm rules má»›i

### 10.2. Lá»£i Ã­ch kinh doanh

- ğŸ“Š **Giáº£m 30% dá»± Ã¡n delay** nhá» phÃ¡t hiá»‡n sá»›m
- ğŸ’° **Tiáº¿t kiá»‡m 25% chi phÃ­** qua kiá»ƒm soÃ¡t ngÃ¢n sÃ¡ch cháº·t
- â° **Cáº£nh bÃ¡o sá»›m 2-3 tuáº§n** trÆ°á»›c khi váº¥n Ä‘á» nghiÃªm trá»ng
- ğŸ‘¥ **Tá»‘i Æ°u phÃ¢n bá»• nguá»“n lá»±c** qua phÃ¡t hiá»‡n overload
- ğŸ“ˆ **TÄƒng tá»· lá»‡ thÃ nh cÃ´ng** dá»± Ã¡n lÃªn 40%

### 10.3. Roadmap phÃ¡t triá»ƒn

**Phase 2: ML Integration**

- Train models tá»« historical data
- Predictive analytics nÃ¢ng cao
- Anomaly detection vá»›i Isolation Forest

**Phase 3: Advanced Features**

- Real-time dashboard vá»›i Chart.js
- Email alerts tá»± Ä‘á»™ng
- Integration vá»›i Slack/Teams
- Risk heatmap visualization

**Phase 4: Enterprise Features**

- Multi-project portfolio analysis
- Resource optimization recommendations
- Cost prediction vá»›i LSTM
- Sentiment analysis trÃªn comments

---

**TÃ i liá»‡u Ä‘Æ°á»£c táº¡o bá»Ÿi**: AI Development Team  
**PhiÃªn báº£n**: 1.0  
**Cáº­p nháº­t láº§n cuá»‘i**: 28/01/2026
